function actionsClubViewDirective(){"use strict";var e=["delete","redact"];return{restrict:"A",scope:{process:"=",type:"=",index:"="},link:function(t,r,o){function n(){t.process===!0?s(t.index,t.type):i()}function s(t,r){var o=void 0===t?-1:+t,n=angular.element(document.querySelectorAll(a));if(n.length)if(-1===o||isNaN(o))n.find(l).prop("disabled",!0);else if(o>=0){var s=n.filter(function(t){if(t!==o)return!0;var n="."+u+"-"+e[r];return jQuery(this).addClass("active").css("display","none").nextAll(n).css("display","block"),!1});s.find(l).prop("disabled",!0)}}function i(){var e=angular.element(document.querySelectorAll(a+" "+l+":disabled")),t=angular.element(document.querySelectorAll(a+".active"));e.length&&e.prop("disabled",!1),t.length&&t.css("display","block").removeClass("active").nextAll().css("display","none")}function c(e){var t=angular.element(document.querySelectorAll(a+":not(.active) "+l+":not(:disabled)"));t.length&&t.prop("disabled",!0)}var a=o.actionsClubView,l=o.children,u=o.baseClassPart;t.$watch("process",n),t.$on("beginClubAction",function(e,t,r){s(t,r)}),t.$on("endClubAction",function(e){i()}),t.$on("endAddProcessClubAction",c)}}}function actionsGridViewDirective(){"use strict";var e,t={active:"active"};return{restrict:"A",scope:{subElementSelector:"@actionsGridView",actionElementsSelector:"@clickSelector",endAction:"="},link:function(r,o,n){function s(o){e=angular.element(o.target).parents(r.subElementSelector),e&&e.addClass(t.active)}function i(r){r===!1&&e&&(e.removeClass(t.active),e=null)}r.$watch("endAction",i),o.on("click",r.actionElementsSelector,s)}}}function backToTopBottomDirective(e,t){"use strict";var r=200,o=17;return{restrict:"A",scope:{backToTopBottom:"@",selectorClass:"@",delay:"@",bottom:"@",isStopCond:"@",stop:"&"},link:function(n,s,i){function c(e){n.isStopCond&&n.stop()||(y?setTimeout(a,y):a())}function a(){clearTimeout(m),u=window.pageYOffset;var r;if(h){var n=e.innerHeight,s=t.height();r=s-n-u,d=s-n}else r=u,d=0;r>1&&(p=r/f*o,h&&(p=-p),200>r&&(p=2*p),l())}function l(){u-=p,window.scroll(0,u),Math.abs(u-d)>Math.abs(p)+2?m=setTimeout(l,o):window.scroll(0,d)}var u,d,p,m,f=parseInt(n.backToTopBottom)||r,y=parseInt(n.delay)||0,h="true"===n.bottom;n.selectorClass?s.on("click","."+n.selectorClass,c):s.on("click",c)}}}function bsTooltipDirective(){"use strict";return{restrict:"A",link:function(e,t,r){t.attr("data-toggle","tooltip"),t.tooltip()}}}function clubNameDirective(e,t,r){"use strict";return{restrict:"A",require:"ngModel",scope:{country:"=country",redactClub:"=redactClub"},link:function(o,n,s,i){function c(){e(function(){n.trigger("checkTouchedFieldView")},0)}i.$asyncValidators.clubName=function(e,n){if(i.$isEmpty(e)||""!==o.redactClub&&e===o.redactClub)return t.when();var s;return s=r.isClubUnique(e,o.country),s.then(c,c),s}}}}function clubOfPlayerAutocompleteDirective(e,t,r){"use strict";return{restrict:"A",require:"ngModel",scope:{checkClub:"=clubOfPlayerAutocomplete",country:"=",selectData:"&onSelect"},link:function(o,n,s,i){function c(e){e.message&&o.selectData({data:e.values}),t(function(){n.trigger("checkTouchedFieldView")},0)}n.autocomplete({source:function(e,t){var o={name:e.term},n=r.searchClubByName(o);n.then(function(e){t(e.values)},function(){t()})},minLength:2,delay:600,select:function(e,t){o.selectData({data:t.item}),o.$apply()}}),n.on("keydown",function(e){o.checkClub=!1,o.$apply()}),n.on("blur",function(e){i.$viewValue=n.val(),o.$apply()}),i.$asyncValidators.clubOfPlayerAutocomplete=function(t,s){if(o.checkClub||i.$isEmpty(t))return e.when();var a,l=t===n.val()?t:n.val();return a=r.getOne(l,o.country,!o.checkClub),a.then(c,c),a}}}}function dlcModalDirective(){"use strict";return{restrict:"E",replace:!0,transclude:!0,templateUrl:"templates/modal.html",scope:{isShown:"=show",header:"@modalTitle",close:"&"},link:function(e,t,r){function o(){e.isShown?document.addEventListener("keyup",n,!1):document.removeEventListener("keyup",n,!1)}function n(t){27===+t.which&&(e.close(),e.$apply())}e.$watch("isShown",o)}}}function dlcNumberDirective(){"use strict";var e=/^[1-9]\d*$/,t=/^0|(?:[1-9]\d*)(?:\.\d+)?$/;return{restrict:"A",require:"ngModel",scope:{dlcNumber:"@"},link:function(r,o,n,s){function i(t){return 0===t||e.test(t)?!0:!1}function c(e){return t.test(e)?!0:!1}s.$validators.dlcNumber=function(e,t){return s.$isEmpty(e)?!0:"integer"===r.dlcNumber?i(e):c(e)}}}}function dlcSortDirective(){"use strict";var e,t={sortClass:"dlc-sort-item",sortAttr:"data-sort-value",sortHideClass:"dlc-sort-hidden"},r='&nbsp;<i class="fa fa-chevron-down '+t.sortHideClass+'"></i><i class="fa fa-chevron-up '+t.sortHideClass+'"></i>';return{restrict:"A",scope:{sort:"=dlcSort"},link:function(o,n,s){function i(r){var n=this.getAttribute(t.sortAttr),s=o.sort.indexOf(n);-1===s||1===s?e="up":0===s&&(e="down",n="-"+n),o.sort=n,a(this),o.$apply()}function c(r,o){e="-"===r[0]?"down":"up";for(var n,s="down"===e?r.substring(1):r,i=0;i<l.length;i++)if(l.eq(i).attr(t.sortAttr)===s){n=l.get(i);break}a(n)}function a(r){l.find("i").each(function(){-1===this.getAttribute("class").indexOf(t.sortHideClass)&&this.setAttribute("class",this.getAttribute("class")+" "+t.sortHideClass)}),r.getElementsByClassName("fa-chevron-"+e)[0].setAttribute("class","fa fa-chevron-"+e)}var l=n.find("."+t.sortClass);l.append(r),e="-"===o.sort[0]?"down":"up";var u="down"===e?o.sort.substring(1):o.sort,d=n.find("."+t.sortClass+"[data-sort-value="+u+"]");d.find(".fa-chevron-"+e).removeClass(t.sortHideClass),l.on("click",i),o.$watch("sort",c)}}}function reactiveForm(e){"use strict";var t=null,r=5e3,o={successForm:"has-success",errorForm:"has-error",success:"alert alert-success",error:"alert alert-danger",notRedacting:"dlc-not-redacting"},n={isDisplayed:!1,addSuccess:"Record added successfully",addError:"When you try to add an entry error occurred",redactSuccess:"Editing was successful",redactError:"When editing error occurred"};return{restrict:"A",require:"form",scope:{actionType:"=",actionResult:"=",clearForm:"=",actionRedact:"="},link:function(s,i,c,a){function l(e,t){""!==e&&("success"===e?p(s.actionType):"error"===e&&m(s.actionType),s.actionResult="",s.actionType="")}function u(e,t){e&&f()}function d(e,t){e?i.find("."+o.notRedacting).prop("readonly",!0):i.find("."+o.notRedacting).prop("readonly",!1)}function p(e){"add"===e?(f(),y(n.addSuccess,o.success)):y(n.redactSuccess,o.success)}function m(e){var t="add"===e?n.addError:n.redactError;y(t,o.error)}function f(){var e=i.find("."+o.successForm),t=i.find("."+o.errorForm),r=i.find("."+b);e.length&&e.removeClass(o.successForm),t.length&&t.removeClass(o.errorForm),r.length&&r.css("display","none"),a.$setPristine(),a.$setUntouched()}function y(o,s){n.isDisplayed&&(h(),t=null),v.addClass(s).text(o),n.isDisplayed=!0,t=e(h,r)}function h(){v.text("").removeClass(),n.isDisplayed=!1}var v=angular.element(document.querySelectorAll(c.messageBox)),b=c.errBlockClass;s.$watch("actionResult",l),s.$watch("clearForm",u),s.$watch("actionRedact",d),s.$on("actionClubError",function(e,t){m(t)}),s.$on("actionClubSuccess",function(e,t){p(t)}),s.$on("clearClubForm",function(e){f()})}}}function touchedFieldView(){"use strict";var e={success:"has-success",error:"has-error"};return{restrict:"A",require:"^form",scope:{param:"@touchedFieldView"},link:function(t,r,o,n){function s(o){var s;n[t.param].$invalid&&n[t.param].$touched?(r.addClass(e.error),s=r.find("."+a),s.length&&s.css("display","block")):r.hasClass(e.error)&&(r.removeClass(e.error),s=r.find("."+a),s.length&&s.css("display","none")),n[t.param].$valid&&n[t.param].$touched&&r.addClass(e.success)}var i=r.find("[name="+t.param+"]"),c=o.checkAjaxView,a=o.errBlockClass;i.length&&(i.on("blur",s),"true"===c&&i.on("checkTouchedFieldView",s))}}}function updateClubsTableViewDirective(){"use strict";var e={chL:"bg-success",euL:"bg-info",clubRemove:"bg-danger-dlc"};return{restrict:"A",scope:{championsLeague:"@chl",leagueEurope:"@el",clubRemove:"@",tableResult:"="},link:function(t,r,o){function n(e){i()}function s(e){setTimeout(i,0)}function i(){var o=r.find(c);o.each(function(r){var o=angular.element(this);r<t.championsLeague&&!o.hasClass(e.chL)?o.addClass(e.chL):r>=t.championsLeague&&o.hasClass(e.chL)&&o.removeClass(e.chL),r>=t.championsLeague&&r<t.leagueEurope&&!o.hasClass(e.euL)?o.addClass(e.euL):(r>=t.leagueEurope||r<t.championsLeague)&&o.hasClass(e.euL)&&o.removeClass(e.euL),0!==+t.clubRemove&&r>=t.clubRemove&&!o.hasClass(e.clubRemove)?o.addClass(e.clubRemove):r<t.clubRemove&&o.hasClass(e.clubRemove)&&o.removeClass(e.clubRemove)})}var c=o.updateClubsTableView;t.$on("updateTableView",function(e){i()}),t.$watch("championsLeague",n),t.$watch("tableResult",s)}}}function arrayHelperService(){"use strict";this.deleteOneByProperty=function(e,t,r){if(void 0!==r)for(var o=0,n=e.length;n>o;o++)if(e[o][t]===r){e.splice(o,1);break}},this.changeOneByPropertyAndSort=function(e,t,r,o){for(var n=0,s=e.length;s>n;n++)if(e[n][r]===t[r]){angular.copy(t,e[n]);break}e.sort(function(e,t){return t[o]-e[o]})},this.addByProperty=function(e,t,r){var o=e.length;if(!o||t[r]<=e[o-1][r])e.push(t);else for(var n=0;o>n;n++)if(t[r]>e[n][r]){e.splice(n,0,t);break}},this.createGroupsFromArray=function(e,t){if(e){for(var r=[],o=[],n=0,s=0;s<e.length;s++)s%t===0&&0!==s&&(r[n]=angular.copy(o),n++,o=[]),o.push(e[s]);return r[n]=angular.copy(o),r}},this.groupByProperty=function(e,t){for(var r=[],o=e.length,n=0;o>n;){var s={propertyName:t,propertyValue:e[n][t],data:[e[n++]]};for(r.push(s);o>n&&e[n][t]===e[n-1][t];)s.data.push(e[n]),n++}return r}}function countryService(e,t){"use strict";this.getOne=function(r){var o=t.defer(),n={method:"GET",url:"lib/country.php",params:{country:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return e(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise},this.getOneBaseInfo=function(r){var o=t.defer(),n={method:"GET",url:"lib/country1.php",params:{country:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return e(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise},this.getAll=function(){var r=t.defer(),o={method:"GET",url:"lib/countries.php",headers:{"X-Requested-With":"XMLHttpRequest"},cache:!0};return e(o).success(function(e,t){e.mistake?r.reject(e,t):r.resolve(e)}).error(function(e,t){r.reject(e,t)}),r.promise}}function playerPositionsService(e,t){this.getAll=function(r,o){var n=e.defer(),s={method:"GET",url:"lib/positions.php",headers:{"X-Requested-With":"XMLHttpRequest"},cache:!0};return t(s).success(function(e,t){void 0===e.mistake&&e.values.length?n.resolve(e):n.reject(e,t)}).error(function(e,t){n.reject(e,t)}),n.promise}}function playerService(e,t){this.getAll=function(r,o,n){var s=e.defer(),i={method:"GET",url:"lib/players.php",params:{club:r,country:o},headers:{"X-Requested-With":"XMLHttpRequest"}};return n&&(n.orderBy&&(i.headers["X-OrderBy"]=n.orderBy,"DESC"===n.direction.toUpperCase()&&(i.headers["X-OrderDirection"]="DESC")),n.limit&&(i.headers["X-Limit"]=n.limit)),t(i).success(function(e,t){void 0!==e.mistake?s.reject(e,t):s.resolve(e)}).error(function(e,t){s.reject(e,t)}),s.promise},this.add=function(r){var o=e.defer(),n={method:"POST",url:"lib/addPlayer.php",data:{player:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return t(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise},this.redact=function(r){var o=e.defer(),n={method:"PUT",url:"lib/redactPlayer.php",data:{player:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return t(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise},this["delete"]=function(r){var o=e.defer(),n={method:"DELETE",url:"lib/deletePlayers.php",data:{player:r.id},headers:{"X-Requested-With":"XMLHttpRequest"}};return t(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise}}function teamService(e,t){"use strict";this.getAll=function(r){var o=t.defer(),n={method:"GET",url:"lib/clubs.php",params:{country:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return e(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise},this.getOne=function(r,o,n){var s=t.defer(),i={method:"GET",url:"lib/club.php",params:{club:r,country:o},headers:{"X-Requested-With":"XMLHttpRequest"}};return n===!0&&(i.params.priorityChecking=1),e(i).success(function(e,t){e.mistake?s.reject(e,t):s.resolve(e)}).error(function(e,t){s.reject(e,t)}),s.promise},this.add=function(r){var o=t.defer(),n={method:"POST",url:"lib/addClub.php",data:{club:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return e(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise},this["delete"]=function(r){var o=t.defer(),n={method:"DELETE",url:"lib/deleteClub.php",data:{club:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return e(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise},this.redact=function(r){var o=t.defer(),n={method:"PUT",url:"lib/redactClub.php",data:{club:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return e(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise},this.isClubUnique=function(r,o){var n=t.defer(),s={method:"GET",url:"lib/club.php",params:{club:r,country:o,uniqueCheck:1},headers:{"X-Requested-With":"XMLHttpRequest"}};return e(s).success(function(e,t){e.mistake?n.resolve():n.reject()}).error(function(e,t){n.reject()}),n.promise},this.searchClubByName=function(r){var o=t.defer(),n={method:"GET",url:"lib/clubSearch.php",params:{club:r.name},headers:{"X-Requested-With":"XMLHttpRequest"}};return e(n).success(function(e,t){for(var r=0,n=e.values.length;n>r;r++)e.values[r].value=e.values[r].name;void 0!==e.mistake?o.reject(t):o.resolve(e)}).error(function(e,t){o.reject(t)}),o.promise}}function topScorerService(e,t){"use strict";this.getAll=function(r,o){var n=e.defer(),s={method:"GET",url:"lib/topScorers.php",params:{country:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return o&&(s.params.limit=o),t(s).success(function(e,t){e.mistake?n.reject(e,t):n.resolve(e)}).error(function(e,t){n.reject(e,t)}),n.promise},this.redact=function(r){var o=e.defer(),n={method:"PUT",url:"lib/redactTopScorer.php",data:{player:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return t(n).success(function(e,t){e.mistake?o.reject(t):o.resolve(e)}).error(function(e,t){o.reject(t)}),o.promise},this["delete"]=function(r){var o=e.defer(),n={method:"DELETE",url:"lib/deletePlayer.php",data:{player:r},headers:{"X-Requested-With":"XMLHttpRequest"}};return t(n).success(function(e,t){e.mistake?o.reject(e,t):o.resolve(e)}).error(function(e,t){o.reject(e,t)}),o.promise}}function fromUrlToStringFtr(){"use strict";return function(e){if(e){var t=e.toLowerCase();return t=t.replace(/\-/i," "),decodeURIComponent(t)}}}function urlLikeFtr(){"use strict";return function(e){if(e){var t=e.toLowerCase();return t=t.replace(/\s/i,"-"),encodeURIComponent(t)}}}function dlcSlideAnimation(){"use strict";function e(e){var r=+e.attr("data-slide-time"),o=+e.attr("data-delay"),n=e.find("button");return isNaN(r)&&(r=t),{slideTime:r,delay:o,buttons:n.length?n:void 0}}var t=500;return{addClass:function(t,r,o){if("ng-hide"===r){var n=e(t);n.buttons&&n.buttons.prop("disabled",!0),isNaN(n.delay)?jQuery(t).slideUp(n.slideTime,o):setTimeout(function(){jQuery(t).slideUp(n.slideTime,o)},n.delay)}},removeClass:function(t,r,o){if("ng-hide"===r){var n=e(t);n.buttons&&n.buttons.prop("disabled",!1),isNaN(n.delay)?jQuery(t).slideDown(n.slideTime,o):setTimeout(function(){jQuery(t).slideDown(n.slideTime,o)},n.delay)}}}}function CountriesController(e,t,r,o){"use strict";function n(){a(o(t.country)),s()}function s(){var e=r.getAll();e.then(i,c)}function i(t){e.countries.values=t.values}function c(e,t){console.log(t,e.mistake)}function a(e){u=e?e:"england"}function l(e){return void 0!==u&&e===u}var u;e.countries={values:[]},e.isCurrentCountry=l,e.$on("$routeChangeSuccess",function(e,t,r){a(t.params.country)}),n()}function CountryController(e,t,r,o){"use strict";function n(){var r=t.country?o(t.country):"england";e.country.data.name=r,s(r)}function s(e){var t=r.getOne(e);t.then(i,c)}function i(t){e.country.isLoading=!1,e.country.isResult=!0,e.country.data=t.value}function c(t,r){e.country.isLoading=!1,e.country.isMistake=!0,e.country.mistakeMessage=t.mistake,console.log(t.status,t.mistake)}e.country={isLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",data:{}},n()}function PlayerActionController(e,t,r){"use strict";function o(){f(),e.chooseClubSettings.priorityCountry=t.country}function n(t){t.$valid?(e.playerToAdd.positionId=+e.playerToAdd.positionId,e.addProcess.isActionForm=!0,e.addProcess.beforeSendMistake=!1,e.addProcess.redacting?l(t):s(t)):e.addProcess.beforeSendMistake=!0}function s(t){e.addProcess.actionType="add",e.playerToAdd.clubId=e.$parent.club.id;var o=r.add(e.playerToAdd);o.then(i,c)}function i(t){e.playerToAdd.id=t.id,e.$parent.endAddPlayer(angular.copy(e.playerToAdd)),f(),e.addProcess.isActionForm=!1,e.addProcess.actionResult="success"}function c(t,r){console.log(r),e.addProcess.isActionForm=!1,e.addProcess.actionResult="error"}function a(t){e.chooseClubSettings.selectedData=!0,e.addProcess.redacting=!0,e.playerToAdd=t}function l(t){e.addProcess.actionType="redact";var o=r.redact(e.playerToAdd);o.then(u,d)}function u(t){e.$parent.endRedactPlayer(angular.copy(e.playerToAdd)),e.addProcess.isActionForm=!1,e.addProcess.actionResult="success"}function d(t,r){console.log(r),e.addProcess.isActionForm=!1,e.addProcess.actionResult="error"}function p(){e.addProcess.redacting&&(e.addProcess.redacting=!1),e.addProcess.beforeSendMistake=!1,f(),e.$parent.cancelAddRedPlayer()}function m(t){e.playerToAdd.clubId=t.id,e.playerToAdd.clubValue=t.name,e.chooseClubSettings.priorityCountry=t.country,e.chooseClubSettings.selectedData=!0}function f(){e.playerToAdd={id:-1,positionId:1}}e.addProcess={isActionForm:!1,actionType:"",actionResult:"",redacting:!1,beforeSendMistake:!1},e.baseFormSettings={minAge:15,maxAge:50,minGoals:0,maxGoals:99,minPasses:0,maxPasses:99,minRating:1,maxRating:10},e.chooseClubSettings={priorityCountry:"",selectedData:!1},e.showClub=m,e.clearPlayerForm=p,e.actionPlayer=n,e.$on("redactPlayer",function(e,t){a(t)}),o()}function PlayersController(e,t,r,o,n,s){"use strict";function i(){var r=s(t.club)||"free",o=s(t.country)||"no country";e.club.name=r,e.club.country=o,u(),c(r,o)}function c(e,t){var o=r.getAll(e,t);o.then(a,l)}function a(t){if(t.values.length){for(var r=m(t.values),o=0,n=r.length;n>o;o++)v(r[o].data[0].positionId,r[o].data[0].position,r[o].data);e.preparePlayers.isResult=!0}else e.preparePlayers.isEmpty=!0,e.preparePlayers.emptyMessage=t.message;e.club.id=t.clubId,e.club.name=t.clubName,e.preparePlayers.showLoading=!1}function l(t,r){e.preparePlayers.showLoading=!1,e.preparePlayers.isMistake=!0,e.preparePlayers.mistakeMessage=t.mistake,console.log(t.status,t.mistake)}function u(){var e=o.getAll();e.then(d,p)}function d(t){e.positions.values=t.values}function p(t,r){e.positions.isMistake=!0,console.log(t.status,t.mistake)}function m(e){return n.groupByProperty(e,"positionId")}function f(e,t){return n.createGroupsFromArray(e,t)}function y(){e.actions.isActionProcess=!0,e.actions.isNeedToShowForm=!0}function h(t){var r,o,n,s;for(delete t.clubValue,n=0,s=e.players.length;s>n;n++)if(t.positionId===e.players[n].positionId){t.position=e.players[n].positionName,r=e.players[n].data;break}if(r)o=r[r.length-1],o.length<L?o.push(t):r.push([t]);else{for(n=0,s=e.positions.values.length;s>n;n++)if(t.positionId===e.positions.values[n].id){t.position=e.positions.values[n].name;break}v(t.positionId,t.position,[t]),e.players.sort(function(e,t){return e.positionId-t.positionId})}e.preparePlayers.isEmpty&&(e.preparePlayers.isEmpty=!1,e.preparePlayers.isResult=!0)}function v(t,r,o){e.players.push({positionId:t,positionName:r+"s",data:f(o,L)})}function b(t,r){e.actions.isActionProcess=!0,e.actions.isNeedToShowForm=!0;var o=angular.copy(t);o.clubValue=e.club.name,e.$broadcast("redactPlayer",o)}function g(e){delete e.clubValue,w(e,1)}function A(){e.actions.isActionProcess=!1,e.actions.isNeedToShowForm=!1}function C(t,r){D.player=t,D.index=r,e.actions.isActionProcess=!0,e.confirmingDeleteWindow.show()}function P(){e.actions.isDeletingProcess=!0;var t=r["delete"](D.player);t.then(T,k)}function S(){D.player={},D.index=-1,e.actions.isDeletingProcess=!1,e.actions.isActionProcess=!1,e.confirmingDeleteWindow.close()}function T(e){w(D.player,0),S()}function k(e,t){S(),console.log(t,e.mistake)}function w(t,r){for(var o=!1,n=0,s=e.players.length;s>n;n++){for(var i=0,c=e.players[n].data.length;c>i;i++){for(var a=0,l=e.players[n].data[i].length;l>a;a++)if(e.players[n].data[i][a].id===t.id){t.clubId===e.club.id&&t.positionId===e.players[n].data[i][a].positionId&&0!==r?e.players[n].data[i][a]=t:(1===e.players[n].data.length&&1===e.players[n].data[i].length?(e.players.splice(n,1),e.players.length||(e.preparePlayers.isEmpty=!0,e.preparePlayers.isResult=!1)):1===e.players[n].data[i].length?e.players[n].data.splice(i,1):e.players[n].data[i].splice(a,1),t.clubId===e.club.id&&1===r&&h(t)),o=!0;break}if(o)break}if(o)break}o||t.clubId!==e.club.id||h(t)}function $(){return-1!==e.club.id}function R(){e.confirmingDeleteWindow.isShown=!1}function M(){e.confirmingDeleteWindow.isShown=!0}var L=4,D={};e.preparePlayers={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",isEmpty:!1,emptyMessage:"There is no players"},e.club={country:"",name:"",id:-1},e.players=[],e.positions={isMistake:!1,values:[]},e.actions={isActionProcess:!1,isDeletingProcess:!1,isNeedToShowForm:!1},e.confirmingDeleteWindow={isShown:!1,close:R,show:M},e.addPlayer=y,e.endAddPlayer=h,e.redactPlayer=b,e.endRedactPlayer=g,e.cancelAddRedPlayer=A,e.deletePlayer=P,e.confirmingDeletionPlayer=C,e.cancelDeletingPlayer=S,e.isClub=$,i()}function TeamController(e,t,r,o,n){"use strict";function s(){var e=n(t.club),r=n(t.country);i(e,r),l(e,r)}function i(e,t){var o=r.getOne(e,t);o.then(c,a)}function c(t){e.club=t.values,e.clubPrepare.showLoading=!1,e.clubPrepare.isResult=!0}function a(t,r){e.clubPrepare.showLoading=!1,e.clubPrepare.isMistake=!0,e.clubPrepare.mistakeMessage=t.mistake,console.log(t.status,t.mistake)}function l(t,r){var n={orderBy:p,direction:"DESC",limit:e.players.topCount},s=o.getAll(t,r,n);s.then(u,d)}function u(t){e.players.showLoading=!1,t.values.length?(e.players.values=t.values,e.players.isResult=!0):e.players.isEmpty=!0}function d(t,r){e.players.showLoading=!1,console.log(t.status,t.mistake)}var p="rating";e.clubPrepare={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:""},e.club={},e.players={showLoading:!0,isResult:!1,isEmpty:!1,topCount:5,values:[]},s()}function TeamsActionController(e,t,r,o){"use strict";function n(){var t=e.clubToAdd;if(void 0!==t.games&&void 0!==t.wins&&void 0!==t.draws){var r=+t.games-t.wins-t.draws;r>=0?t.defeats=r:(t.defeats=0,t.draws=t.games-t.wins),t.points=3*t.wins+t.draws}}function s(t){t.$valid?(e.addProcess.isActionForm=!0,e.addProcess.beforeSendMistake=!1,e.addProcess.redacting?u(t):i(t)):e.addProcess.beforeSendMistake=!0}function i(t){e.addProcess.actionType="add",e.clubToAdd.countryId=e.$parent.country.id;var o=r.add(e.clubToAdd);o.then(c,a)}function c(r){e.clubToAdd.id=r.value,o.addByProperty(e.$parent.clubs.values,e.clubToAdd,"points"),e.$parent.checkIfIsEmpty(),e.clubToAdd={},e.addProcess.isActionForm=!1,e.addProcess.actionResult="success",t(function(){e.$parent.$broadcast("updateTableView"),e.$parent.$broadcast("endAddProcessClubAction")},0)}function a(t,r){console.log(r,t.mistake),e.addProcess.isActionForm=!1,e.addProcess.actionResult="error"}function l(t){e.addProcess.redacting=!0,e.addProcess.redactClubName=t.name,angular.copy(t,e.clubToAdd)}function u(t){e.addProcess.actionType="redact";var o=r.redact(e.clubToAdd);o.then(d,p)}function d(r){o.changeOneByPropertyAndSort(e.$parent.clubs.values,e.clubToAdd,"id","points"),e.addProcess.isActionForm=!1,e.addProcess.actionResult="success",t(function(){e.$parent.$broadcast("updateTableView")},0)}function p(t,r){console.log(r,t.mistake),e.addProcess.isActionForm=!1,e.addProcess.actionResult="error"}function m(){e.addProcess.redacting&&(e.addProcess.redacting=!1,e.addProcess.redactClubName=""),e.addProcess.beforeSendMistake=!1,e.clubToAdd={},e.$parent.cancelAddRedClub()}e.clubToAdd={},e.addProcess={isActionForm:!1,actionType:"",actionResult:"",redacting:!1,redactClubName:"",beforeSendMistake:!1},e.createDefeatsAndPointsIfNeed=n,e.actionClub=s,e.clearClubForm=m,e.$on("redactClub",function(e,t){l(t)})}function TeamsController(e,t,r,o,n,s,i){"use strict";function c(){a();var r=t.country?i(t.country):"england";e.country.name=r,l(r),p(r)}function a(){e.clubActions.isNeedToShowForm=!1,e.clubActions.isActionProcess=!1,e.clubActions.isDeletingProcess=!1,e.clubActions.indexAction=-1,e.clubActions.typeAction=-1}function l(e){var t=o.getAll(e);t.then(u,d)}function u(t){e.clubs.showLoading=!1,t.values.length?(e.clubs.values=t.values,e.clubs.isResult=!0):e.clubs.isEmpty=!0}function d(t,r){e.clubs.showLoading=!1,e.clubs.isMistake=!0,e.clubs.mistakeMessage=t.mistake,console.log(t.status,t.mistake)}function p(e){var t=n.getOneBaseInfo(e);t.then(m,f)}function m(t){e.country.maxGames=+t.value.maxGames,e.country.chL=+t.value.chL,e.country.euL=+t.value.euL,e.country.id=+t.value.id,e.country.clubsToRemove=+t.value.clubsToRemove,e.country.maxCountClubs=+t.value.maxCountClubs}function f(t,r){e.country.isMistake=!0,console.log(t.status,t.mistake)}function y(){T()?e.okMaxClubMessage.show():(e.clubActions.isActionProcess=!0,e.clubActions.isNeedToShowForm=!0)}function h(t,r){e.clubActions.isActionProcess=!0,e.clubActions.isNeedToShowForm=!0,e.clubActions.indexAction=r,e.clubActions.typeAction=1,e.$broadcast("redactClub",t)}function v(){a()}function b(t,r){M=t,e.clubActions.isActionProcess=!0,e.clubActions.indexAction=r,e.clubActions.typeAction=0,e.confirmingDeleteWindow.show()}function g(){e.clubActions.isDeletingProcess=!0;var t=o["delete"](M.id);t.then(C,P)}function A(){M={},a(),e.confirmingDeleteWindow.close()}function C(t){s.deleteOneByProperty(e.clubs.values,"id",M.id),e.clubs.values||(e.clubs.isEmpty=!0,e.clubs.isResult=!1),A(),r(function(){e.$broadcast("updateTableView")},0)}function P(e,t){A(),console.log(t,e.mistake)}function S(){e.clubs.isEmpty&&(e.clubs.isEmpty=!1,e.clubs.isResult=!0)}function T(){return e.clubs.values.length===e.country.maxCountClubs}function k(){e.confirmingDeleteWindow.isShown=!1}function w(){e.confirmingDeleteWindow.isShown=!0}function $(){e.okMaxClubMessage.isShown=!1}function R(){e.okMaxClubMessage.isShown=!0}var M={};e.clubs={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",isEmpty:!1,values:[]},e.country={id:0,name:"",maxGames:0,maxCountClubs:0,chL:0,euL:0,clubsToRemove:0,isMistake:!1},e.clubActions={},e.showAddClub=y,e.cancelAddRedClub=v,e.redactClub=h,e.deleteClub=g,e.confirmingDeletionClub=b,e.cancelDeletingClub=A,e.checkIfIsEmpty=S,e.checkMaxClubsCount=T,e.confirmingDeleteWindow={isShown:!1,close:k,show:w},e.okMaxClubMessage={isShown:!1,show:R,close:$},c()}function TopScorerActionController(e,t,r){function o(){u()}function n(t){t.$valid?(e.addProcess.isActionForm=!0,e.addProcess.beforeSendMistake=!1,e.playerToAdd.clubId=e.$parent.country.clubs[e.playerToAdd.clubValue].id,e.playerToAdd.clubName=e.$parent.country.clubs[e.playerToAdd.clubValue].name,i(t)):e.addProcess.beforeSendMistake=!0}function s(t){e.addProcess.redacting=!0,angular.copy(t,e.playerToAdd),e.playerToAdd.clubValue=d(t.clubName)}function i(r){e.addProcess.actionType="redact";var o=t.redact(e.playerToAdd);o.then(c,a)}function c(t){var o=angular.copy(e.playerToAdd);delete o.clubValue,r.changeOneByPropertyAndSort(e.$parent.topScorers.values,o,"id","goals"),e.addProcess.isActionForm=!1,e.addProcess.actionResult="success"}function a(t,r){e.addProcess.isActionForm=!1,e.addProcess.actionResult="error",console.log(r,t.mistake)}function l(){e.addProcess.redacting&&(e.addProcess.redacting=!1),e.addProcess.beforeSendMistake=!1,u(),e.$parent.cancelAddRedPlayer()}function u(){e.playerToAdd={id:-1,clubValue:0}}function d(t){for(var r=0,o=e.$parent.country.clubs.length;o>r;r++)if(e.$parent.country.clubs[r].name===t)return r}e.addProcess={isActionForm:!1,actionType:"",actionResult:"",redacting:!1,beforeSendMistake:!1},e.baseFormSettings={minGoals:1,maxGoals:99},e.actionPlayer=n,e.clearPlayerForm=l,e.$on("redactPlayer",function(e,t){s(t)}),o()}function TopScorersController(e,t,r,o,n,s,i){"use strict";function c(){var r=t.country?i(t.country):"england";e.country.name=r,a(),l(r)}function a(){e.actions.isNeedToShowForm=!1,e.actions.isActionProcess=!1,e.actions.isDeletingProcess=!1,e.actions.indexAction=-1,e.actions.typeAction=-1}function l(e){var t=r.getAll(e,T);t.then(u,d)}function u(t){e.topScorers.showLoading=!1,t.values.length?(e.topScorers.values=t.values,e.topScorers.isResult=!0):e.topScorers.isEmpty=!0}function d(t,r){e.topScorers.showLoading=!1,e.topScorers.isMistake=!0,e.topScorers.mistakeMessage=t.mistake,console.log(t.status,t.mistake)}function p(t){e.country.showLoading=!0,e.country.isMistake=!1;var r=o.getAll(t);r.then(m,f)}function m(t){k=!0,e.country.clubs=t.values,e.country.showLoading=!1,n(function(){y(w,e.actions.indexAction),w=null},0)}function f(t,r){e.country.showLoading=!1,e.country.isMistake=!0,console.log(t.status,t.mistake)}function y(t,r){e.actions.isActionProcess=!0,e.actions.typeAction=1,e.actions.indexAction=r,k?(e.$broadcast("redactPlayer",t),e.actions.isNeedToShowForm=!0):(w=t,p(e.country.name))}function h(){a()}function v(t,r){$=t,e.actions.typeAction=0,e.actions.indexAction=r,e.actions.isActionProcess=!0,e.confirmingDeleteWindow.show()}function b(){e.actions.isDeletingProcess=!0;var t=r["delete"]($.id);t.then(A,C)}function g(){$={},a(),e.confirmingDeleteWindow.close()}function A(t){s.deleteOneByProperty(e.topScorers.values,"id",$.id),g()}function C(e,t){g(),console.log(t,e.mistake)}function P(){e.confirmingDeleteWindow.isShown=!1}function S(){e.confirmingDeleteWindow.isShown=!0}var T=25,k=!1,w=null,$={};e.topScorers={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",isEmpty:!1,currentSort:"-goals",values:[]},e.country={showLoading:!1,isMistake:!1,name:"",clubs:[]},e.actions={},e.redactPlayer=y,e.deletePlayer=b,e.cancelAddRedPlayer=h,e.confirmingDeletionPlayer=v,e.cancelDeletingPlayer=g,e.confirmingDeleteWindow={isShown:!1,close:P,show:S},c()}angular.module("myApp").directive("actionsClubView",actionsClubViewDirective),angular.module("myApp").directive("actionsGridView",actionsGridViewDirective),angular.module("myApp").directive("backToTopBottom",backToTopBottomDirective),backToTopBottomDirective.$inject=["$window","$document"],angular.module("myApp").directive("bsTooltip",bsTooltipDirective),angular.module("myApp").directive("clubName",clubNameDirective),clubNameDirective.$inject=["$timeout","$q","teamService"],angular.module("myApp").directive("clubOfPlayerAutocomplete",clubOfPlayerAutocompleteDirective),clubOfPlayerAutocompleteDirective.$inject=["$q","$timeout","teamService"],angular.module("myApp").directive("dlcModal",dlcModalDirective),angular.module("myApp").directive("dlcNumber",dlcNumberDirective),angular.module("myApp").directive("dlcSort",dlcSortDirective),angular.module("myApp").directive("reactiveForm",reactiveForm),reactiveForm.$inject=["$timeout"],angular.module("myApp").directive("touchedFieldView",touchedFieldView),angular.module("myApp").directive("updateClubsTableView",updateClubsTableViewDirective),angular.module("myApp").service("arrayHelperService",arrayHelperService),angular.module("myApp").service("countryService",countryService),countryService.$inject=["$http","$q"],angular.module("myApp").service("playerPositionsService",playerPositionsService),
playerPositionsService.$inject=["$q","$http"],angular.module("myApp").service("playerService",playerService),playerService.$inject=["$q","$http"],angular.module("myApp").service("teamService",teamService),teamService.$inject=["$http","$q"],angular.module("myApp").service("topScorerService",topScorerService),topScorerService.$inject=["$q","$http"],angular.module("myApp").filter("fromUrlToString",fromUrlToStringFtr),angular.module("myApp").filter("urlLike",urlLikeFtr),angular.module("myApp").animation(".dlc-slide-animation",dlcSlideAnimation),angular.module("myApp").controller("CountriesController",CountriesController),CountriesController.$inject=["$scope","$routeParams","countryService","fromUrlToStringFilter"],angular.module("myApp").controller("CountryController",CountryController),CountryController.$inject=["$scope","$routeParams","countryService","fromUrlToStringFilter"],angular.module("myApp").controller("PlayerActionController",PlayerActionController),PlayerActionController.$inject=["$scope","$routeParams","playerService"],angular.module("myApp").controller("PlayersController",PlayersController),PlayersController.$inject=["$scope","$routeParams","playerService","playerPositionsService","arrayHelperService","fromUrlToStringFilter"],angular.module("myApp").controller("TeamController",TeamController),TeamController.$inject=["$scope","$routeParams","teamService","playerService","fromUrlToStringFilter"],angular.module("myApp").controller("TeamsActionController",TeamsActionController),TeamsActionController.$inject=["$scope","$timeout","teamService","arrayHelperService"],angular.module("myApp").controller("TeamsController",TeamsController),TeamsController.$inject=["$scope","$routeParams","$timeout","teamService","countryService","arrayHelperService","fromUrlToStringFilter"],angular.module("myApp").controller("TopScorerActionController",TopScorerActionController),TopScorerActionController.$inject=["$scope","topScorerService","arrayHelperService"],angular.module("myApp").controller("TopScorersController",TopScorersController),TopScorersController.$inject=["$scope","$routeParams","topScorerService","teamService","$timeout","arrayHelperService","fromUrlToStringFilter"];