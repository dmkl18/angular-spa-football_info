function CountriesController(e,o,n,t,s){"use strict";function r(){l(s(o.country)),a()}function a(){var e=t.getAll();e.then(i,c)}function i(o){e.countries.values=o.values}function c(e,o){console.log(o,e.mistake)}function l(e){p=e?e:"england"}function u(e){return void 0!==p&&e===p}function d(e){return-1!==n.path().indexOf("country")&&u(e)}var p;e.countries={values:[]},e.isCurrentCountry=u,e.isCurrentCountryAndInPath=d,e.$on("$routeChangeSuccess",function(e,o,n){l(o.params.country)}),r()}function CountryController(e,o,n,t){"use strict";function s(){var n=o.country?t(o.country):"england";e.country.data.name=n,r(n)}function r(e){var o=n.getOne(e);o.then(a,i)}function a(o){e.country.isLoading=!1,e.country.isResult=!0,e.country.data=o.value}function i(o,n){e.country.isLoading=!1,e.country.isMistake=!0,e.country.mistakeMessage=o.mistake,console.log(o.status,o.mistake)}e.country={isLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",data:{}},s()}function CountryPlayersController(e,o,n,t,s){"use strict";function r(){var n=t(o.country),s=+o.page;if(!s||0>=s){if(void 0!==o.page)return e.playersPrepare.showLoading=!1,e.playersPrepare.isMistake=!0,void(e.playersPrepare.mistakeMessage="You must enter a correct number of page");s=1}a(n,s),e.players.page=s,e.players.country=n}function a(e,o){var t=n.getAllByPage(e,o,l);t.then(i,c)}function i(o){e.players.values=s.createGroupsFromArray(o.values,u),e.players.page=o.page,e.players.pages=o.pages,e.playersPrepare.showLoading=!1,e.playersPrepare.isResult=!0}function c(o,n){e.playersPrepare.showLoading=!1,e.playersPrepare.isMistake=!0,e.playersPrepare.mistakeMessage=o.mistake,console.log(o.mistake,o.status)}var l=24,u=4;e.playersPrepare={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",isEmpty:!1,emptyMessage:"There is no information about players of the country"},e.players={values:[],page:0,pages:0,country:""},r()}function PlayerActionController(e,o,n){"use strict";function t(){m(),e.chooseClubSettings.priorityCountry=o.country}function s(o){o.$valid?(e.playerToAdd.positionId=+e.playerToAdd.positionId,e.addProcess.isActionForm=!0,e.addProcess.beforeSendMistake=!1,e.addProcess.redacting?l(o):r(o)):e.addProcess.beforeSendMistake=!0}function r(o){e.addProcess.actionType="add",e.playerToAdd.clubId=e.$parent.club.id;var t=n.add(e.playerToAdd);t.then(a,i)}function a(o){e.playerToAdd.id=o.id,e.$parent.endAddPlayer(angular.copy(e.playerToAdd)),m(),e.addProcess.isActionForm=!1,e.addProcess.actionResult="success"}function i(o,n){console.log(n),e.addProcess.isActionForm=!1,e.addProcess.actionResult="error"}function c(o){e.chooseClubSettings.selectedData=!0,e.addProcess.redacting=!0,e.playerToAdd=o}function l(o){e.addProcess.actionType="redact";var t=n.redact(e.playerToAdd);t.then(u,d)}function u(o){e.$parent.endRedactPlayer(angular.copy(e.playerToAdd)),e.addProcess.isActionForm=!1,e.addProcess.actionResult="success"}function d(o,n){console.log(n),e.addProcess.isActionForm=!1,e.addProcess.actionResult="error"}function p(){e.addProcess.redacting&&(e.addProcess.redacting=!1),e.addProcess.beforeSendMistake=!1,m(),e.$parent.cancelAddRedPlayer()}function y(o){e.playerToAdd.clubId=o.id,e.playerToAdd.clubValue=o.name,e.chooseClubSettings.priorityCountry=o.country,e.chooseClubSettings.selectedData=!0}function m(){e.playerToAdd={id:-1,positionId:1}}e.addProcess={isActionForm:!1,actionType:"",actionResult:"",redacting:!1,beforeSendMistake:!1},e.baseFormSettings={minAge:15,maxAge:50,minGoals:0,maxGoals:99,minPasses:0,maxPasses:99,minRating:1,maxRating:10},e.chooseClubSettings={priorityCountry:"",selectedData:!1},e.showClub=y,e.clearPlayerForm=p,e.actionPlayer=s,e.$on("redactPlayer",function(e,o){c(o)}),t()}function PlayersController(e,o,n,t,s,r){"use strict";function a(){var n=r(o.club)||"free",t=r(o.country)||"no country";e.club.name=n,e.club.country=t,u(),i(n,t)}function i(e,o){var t=n.getAll(e,o);t.then(c,l)}function c(o){if(o.values.length){for(var n=y(o.values),t=0,s=n.length;s>t;t++)P(n[t].data[0].positionId,n[t].data[0].position,n[t].data);e.preparePlayers.isResult=!0}else e.preparePlayers.isEmpty=!0,e.preparePlayers.emptyMessage=o.message;e.club.id=o.clubId,e.club.name=o.clubName,e.preparePlayers.showLoading=!1}function l(o,n){e.preparePlayers.showLoading=!1,e.preparePlayers.isMistake=!0,e.preparePlayers.mistakeMessage=o.mistake,console.log(o.status,o.mistake)}function u(){var e=t.getAll();e.then(d,p)}function d(o){e.positions.values=o.values}function p(o,n){e.positions.isMistake=!0,console.log(o.status,o.mistake)}function y(e){return s.groupByProperty(e,"positionId")}function m(e,o){return s.createGroupsFromArray(e,o)}function f(){e.actions.isActionProcess=!0,e.actions.isNeedToShowForm=!0}function g(o){var n,t,s,r;for(delete o.clubValue,s=0,r=e.players.length;r>s;s++)if(o.positionId===e.players[s].positionId){o.position=e.players[s].positionName,n=e.players[s].data;break}if(n)t=n[n.length-1],t.length<F?t.push(o):n.push([o]);else{for(s=0,r=e.positions.values.length;r>s;s++)if(o.positionId===e.positions.values[s].id){o.position=e.positions.values[s].name;break}P(o.positionId,o.position,[o]),e.players.sort(function(e,o){return e.positionId-o.positionId})}e.preparePlayers.isEmpty&&(e.preparePlayers.isEmpty=!1,e.preparePlayers.isResult=!0)}function P(o,n,t){e.players.push({positionId:o,positionName:n+"s",data:m(t,F)})}function b(o,n){e.actions.isActionProcess=!0,e.actions.isNeedToShowForm=!0;var t=angular.copy(o);t.clubValue=e.club.name,e.$broadcast("redactPlayer",t)}function A(e){delete e.clubValue,w(e,1)}function v(){e.actions.isActionProcess=!1,e.actions.isNeedToShowForm=!1}function h(o,n){D.player=o,D.index=n,e.actions.isActionProcess=!0,e.confirmingDeleteWindow.show()}function C(){e.actions.isDeletingProcess=!0;var o=n["delete"](D.player);o.then(T,k)}function S(){D.player={},D.index=-1,e.actions.isDeletingProcess=!1,e.actions.isActionProcess=!1,e.confirmingDeleteWindow.close()}function T(e){w(D.player,0),S()}function k(e,o){S(),console.log(o,e.mistake)}function w(o,n){for(var t=!1,s=0,r=e.players.length;r>s;s++){for(var a=0,i=e.players[s].data.length;i>a;a++){for(var c=0,l=e.players[s].data[a].length;l>c;c++)if(e.players[s].data[a][c].id===o.id){o.clubId===e.club.id&&o.positionId===e.players[s].data[a][c].positionId&&0!==n?e.players[s].data[a][c]=o:(1===e.players[s].data.length&&1===e.players[s].data[a].length?(e.players.splice(s,1),e.players.length||(e.preparePlayers.isEmpty=!0,e.preparePlayers.isResult=!1)):1===e.players[s].data[a].length?e.players[s].data.splice(a,1):e.players[s].data[a].splice(c,1),o.clubId===e.club.id&&1===n&&g(o)),t=!0;break}if(t)break}if(t)break}t||o.clubId!==e.club.id||g(o)}function $(){return-1!==e.club.id}function M(){e.confirmingDeleteWindow.isShown=!1}function R(){e.confirmingDeleteWindow.isShown=!0}var F=4,D={};e.preparePlayers={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",isEmpty:!1,emptyMessage:"There is no players"},e.club={country:"",name:"",id:-1},e.players=[],e.positions={isMistake:!1,values:[]},e.actions={isActionProcess:!1,isDeletingProcess:!1,isNeedToShowForm:!1},e.confirmingDeleteWindow={isShown:!1,close:M,show:R},e.addPlayer=f,e.endAddPlayer=g,e.redactPlayer=b,e.endRedactPlayer=A,e.cancelAddRedPlayer=v,e.deletePlayer=C,e.confirmingDeletionPlayer=h,e.cancelDeletingPlayer=S,e.isClub=$,a()}function TeamController(e,o,n,t,s){"use strict";function r(){var e=s(o.club),n=s(o.country);a(e,n),l(e,n)}function a(e,o){var t=n.getOne(e,o);t.then(i,c)}function i(o){e.club=o.values,e.clubPrepare.showLoading=!1,e.clubPrepare.isResult=!0}function c(o,n){e.clubPrepare.showLoading=!1,e.clubPrepare.isMistake=!0,e.clubPrepare.mistakeMessage=o.mistake,console.log(o.status,o.mistake)}function l(o,n){var s={orderBy:p,direction:"DESC",limit:e.players.topCount},r=t.getAll(o,n,s);r.then(u,d)}function u(o){e.players.showLoading=!1,o.values.length?(e.players.values=o.values,e.players.isResult=!0):e.players.isEmpty=!0}function d(o,n){e.players.showLoading=!1,console.log(o.status,o.mistake)}var p="rating";e.clubPrepare={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:""},e.club={},e.players={showLoading:!0,isResult:!1,isEmpty:!1,topCount:5,values:[]},r()}function TeamsActionController(e,o,n,t){"use strict";function s(){var o=e.clubToAdd;if(void 0!==o.games&&void 0!==o.wins&&void 0!==o.draws){var n=+o.games-o.wins-o.draws;n>=0?o.defeats=n:(o.defeats=0,o.draws=o.games-o.wins),o.points=3*o.wins+o.draws}}function r(o){o.$valid?(e.addProcess.isActionForm=!0,e.addProcess.beforeSendMistake=!1,e.addProcess.redacting?u(o):a(o)):e.addProcess.beforeSendMistake=!0}function a(o){e.addProcess.actionType="add",e.clubToAdd.countryId=e.$parent.country.id;var t=n.add(e.clubToAdd);t.then(i,c)}function i(n){e.clubToAdd.id=n.value,t.addByProperty(e.$parent.clubs.values,e.clubToAdd,"points"),e.$parent.checkIfIsEmpty(),e.clubToAdd={},e.addProcess.isActionForm=!1,e.addProcess.actionResult="success",o(function(){e.$parent.$broadcast("updateTableView"),e.$parent.$broadcast("endAddProcessClubAction")},0)}function c(o,n){console.log(n,o.mistake),e.addProcess.isActionForm=!1,e.addProcess.actionResult="error"}function l(o){e.addProcess.redacting=!0,e.addProcess.redactClubName=o.name,angular.copy(o,e.clubToAdd)}function u(o){e.addProcess.actionType="redact";var t=n.redact(e.clubToAdd);t.then(d,p)}function d(n){t.changeOneByPropertyAndSort(e.$parent.clubs.values,e.clubToAdd,"id","points"),e.addProcess.isActionForm=!1,e.addProcess.actionResult="success",o(function(){e.$parent.$broadcast("updateTableView")},0)}function p(o,n){console.log(n,o.mistake),e.addProcess.isActionForm=!1,e.addProcess.actionResult="error"}function y(){e.addProcess.redacting&&(e.addProcess.redacting=!1,e.addProcess.redactClubName=""),e.addProcess.beforeSendMistake=!1,e.clubToAdd={},e.$parent.cancelAddRedClub()}e.clubToAdd={},e.addProcess={isActionForm:!1,actionType:"",actionResult:"",redacting:!1,redactClubName:"",beforeSendMistake:!1},e.createDefeatsAndPointsIfNeed=s,e.actionClub=r,e.clearClubForm=y,e.$on("redactClub",function(e,o){l(o)})}function TeamsController(e,o,n,t,s,r,a){"use strict";function i(){c();var n=o.country?a(o.country):"england";e.country.name=n,l(n),p(n)}function c(){e.clubActions.isNeedToShowForm=!1,e.clubActions.isActionProcess=!1,e.clubActions.isDeletingProcess=!1,e.clubActions.indexAction=-1,e.clubActions.typeAction=-1}function l(e){var o=t.getAll(e);o.then(u,d)}function u(o){e.clubs.showLoading=!1,o.values.length?(e.clubs.values=o.values,e.clubs.isResult=!0):e.clubs.isEmpty=!0}function d(o,n){e.clubs.showLoading=!1,e.clubs.isMistake=!0,e.clubs.mistakeMessage=o.mistake,console.log(o.status,o.mistake)}function p(e){var o=s.getOneBaseInfo(e);o.then(y,m)}function y(o){e.country.maxGames=+o.value.maxGames,e.country.chL=+o.value.chL,e.country.euL=+o.value.euL,e.country.id=+o.value.id,e.country.clubsToRemove=+o.value.clubsToRemove,e.country.maxCountClubs=+o.value.maxCountClubs}function m(o,n){e.country.isMistake=!0,console.log(o.status,o.mistake)}function f(){T()?e.okMaxClubMessage.show():(e.clubActions.isActionProcess=!0,e.clubActions.isNeedToShowForm=!0)}function g(o,n){e.clubActions.isActionProcess=!0,e.clubActions.isNeedToShowForm=!0,e.clubActions.indexAction=n,e.clubActions.typeAction=1,e.$broadcast("redactClub",o)}function P(){c()}function b(o,n){R=o,e.clubActions.isActionProcess=!0,e.clubActions.indexAction=n,e.clubActions.typeAction=0,e.confirmingDeleteWindow.show()}function A(){e.clubActions.isDeletingProcess=!0;var o=t["delete"](R.id);o.then(h,C)}function v(){R={},c(),e.confirmingDeleteWindow.close()}function h(o){r.deleteOneByProperty(e.clubs.values,"id",R.id),e.clubs.values||(e.clubs.isEmpty=!0,e.clubs.isResult=!1),v(),n(function(){e.$broadcast("updateTableView")},0)}function C(e,o){v(),console.log(o,e.mistake)}function S(){e.clubs.isEmpty&&(e.clubs.isEmpty=!1,e.clubs.isResult=!0)}function T(){return e.clubs.values.length===e.country.maxCountClubs}function k(){e.confirmingDeleteWindow.isShown=!1}function w(){e.confirmingDeleteWindow.isShown=!0}function $(){e.okMaxClubMessage.isShown=!1}function M(){e.okMaxClubMessage.isShown=!0}var R={};e.clubs={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",isEmpty:!1,values:[]},e.country={id:0,name:"",maxGames:0,maxCountClubs:0,chL:0,euL:0,clubsToRemove:0,isMistake:!1},e.clubActions={},e.showAddClub=f,e.cancelAddRedClub=P,e.redactClub=g,e.deleteClub=A,e.confirmingDeletionClub=b,e.cancelDeletingClub=v,e.checkIfIsEmpty=S,e.checkMaxClubsCount=T,e.confirmingDeleteWindow={isShown:!1,close:k,show:w},e.okMaxClubMessage={isShown:!1,show:M,close:$},i()}function TopScorerActionController(e,o,n){function t(){u()}function s(o){o.$valid?(e.addProcess.isActionForm=!0,e.addProcess.beforeSendMistake=!1,e.playerToAdd.clubId=e.$parent.country.clubs[e.playerToAdd.clubValue].id,e.playerToAdd.clubName=e.$parent.country.clubs[e.playerToAdd.clubValue].name,a(o)):e.addProcess.beforeSendMistake=!0}function r(o){e.addProcess.redacting=!0,angular.copy(o,e.playerToAdd),e.playerToAdd.clubValue=d(o.clubName)}function a(n){e.addProcess.actionType="redact";var t=o.redact(e.playerToAdd);t.then(i,c)}function i(o){var t=angular.copy(e.playerToAdd);delete t.clubValue,n.changeOneByPropertyAndSort(e.$parent.topScorers.values,t,"id","goals"),e.addProcess.isActionForm=!1,e.addProcess.actionResult="success"}function c(o,n){e.addProcess.isActionForm=!1,e.addProcess.actionResult="error",console.log(n,o.mistake)}function l(){e.addProcess.redacting&&(e.addProcess.redacting=!1),e.addProcess.beforeSendMistake=!1,u(),e.$parent.cancelAddRedPlayer()}function u(){e.playerToAdd={id:-1,clubValue:0}}function d(o){for(var n=0,t=e.$parent.country.clubs.length;t>n;n++)if(e.$parent.country.clubs[n].name===o)return n}e.addProcess={isActionForm:!1,actionType:"",actionResult:"",redacting:!1,beforeSendMistake:!1},e.baseFormSettings={minGoals:1,maxGoals:99},e.actionPlayer=s,e.clearPlayerForm=l,e.$on("redactPlayer",function(e,o){r(o)}),t()}function TopScorersController(e,o,n,t,s,r,a){"use strict";function i(){var n=o.country?a(o.country):"england";e.country.name=n,c(),l(n)}function c(){e.actions.isNeedToShowForm=!1,e.actions.isActionProcess=!1,e.actions.isDeletingProcess=!1,e.actions.indexAction=-1,e.actions.typeAction=-1}function l(e){var o=n.getAll(e,T);o.then(u,d)}function u(o){e.topScorers.showLoading=!1,o.values.length?(e.topScorers.values=o.values,e.topScorers.isResult=!0):e.topScorers.isEmpty=!0}function d(o,n){e.topScorers.showLoading=!1,e.topScorers.isMistake=!0,e.topScorers.mistakeMessage=o.mistake,console.log(o.status,o.mistake)}function p(o){e.country.showLoading=!0,e.country.isMistake=!1;var n=t.getAll(o);n.then(y,m)}function y(o){k=!0,e.country.clubs=o.values,e.country.showLoading=!1,s(function(){f(w,e.actions.indexAction),w=null},0)}function m(o,n){e.country.showLoading=!1,e.country.isMistake=!0,console.log(o.status,o.mistake)}function f(o,n){e.actions.isActionProcess=!0,e.actions.typeAction=1,e.actions.indexAction=n,k?(e.$broadcast("redactPlayer",o),e.actions.isNeedToShowForm=!0):(w=o,p(e.country.name))}function g(){c()}function P(o,n){$=o,e.actions.typeAction=0,e.actions.indexAction=n,e.actions.isActionProcess=!0,e.confirmingDeleteWindow.show()}function b(){e.actions.isDeletingProcess=!0;var o=n["delete"]($.id);o.then(v,h)}function A(){$={},c(),e.confirmingDeleteWindow.close()}function v(o){r.deleteOneByProperty(e.topScorers.values,"id",$.id),A()}function h(e,o){A(),console.log(o,e.mistake)}function C(){e.confirmingDeleteWindow.isShown=!1}function S(){e.confirmingDeleteWindow.isShown=!0}var T=25,k=!1,w=null,$={};e.topScorers={showLoading:!0,isResult:!1,isMistake:!1,mistakeMessage:"",isEmpty:!1,currentSort:"-goals",values:[]},e.country={showLoading:!1,isMistake:!1,name:"",clubs:[]},e.actions={},e.redactPlayer=f,e.deletePlayer=b,e.cancelAddRedPlayer=g,e.confirmingDeletionPlayer=P,e.cancelDeletingPlayer=A,e.confirmingDeleteWindow={isShown:!1,close:C,show:S},i()}angular.module("myApp").controller("CountriesController",CountriesController),CountriesController.$inject=["$scope","$routeParams","$location","countryService","fromUrlToStringFilter"],angular.module("myApp").controller("CountryController",CountryController),CountryController.$inject=["$scope","$routeParams","countryService","fromUrlToStringFilter"],angular.module("myApp").controller("CountryPlayersController",CountryPlayersController),CountryPlayersController.$inject=["$scope","$routeParams","playerService","fromUrlToStringFilter","arrayHelperService"],angular.module("myApp").controller("PlayerActionController",PlayerActionController),PlayerActionController.$inject=["$scope","$routeParams","playerService"],angular.module("myApp").controller("PlayersController",PlayersController),PlayersController.$inject=["$scope","$routeParams","playerService","playerPositionsService","arrayHelperService","fromUrlToStringFilter"],angular.module("myApp").controller("TeamController",TeamController),TeamController.$inject=["$scope","$routeParams","teamService","playerService","fromUrlToStringFilter"],angular.module("myApp").controller("TeamsActionController",TeamsActionController),TeamsActionController.$inject=["$scope","$timeout","teamService","arrayHelperService"],angular.module("myApp").controller("TeamsController",TeamsController),TeamsController.$inject=["$scope","$routeParams","$timeout","teamService","countryService","arrayHelperService","fromUrlToStringFilter"],angular.module("myApp").controller("TopScorerActionController",TopScorerActionController),TopScorerActionController.$inject=["$scope","topScorerService","arrayHelperService"],angular.module("myApp").controller("TopScorersController",TopScorersController),TopScorersController.$inject=["$scope","$routeParams","topScorerService","teamService","$timeout","arrayHelperService","fromUrlToStringFilter"];